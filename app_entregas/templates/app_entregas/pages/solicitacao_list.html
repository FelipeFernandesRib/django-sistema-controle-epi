{% extends "app_core/partials/base.html" %}
{% block title %}Minhas Solicitações{% endblock %}
{% block page_title %}Minhas Solicitações{% endblock %}
{% block breadcrumb %}<a href="{% url 'app_core:home' %}">Início</a> › Minhas Solicitações{% endblock %}
{% block content %}
<div class="card">
  <div class="card-header" style="display:flex; justify-content:space-between; align-items:center;">
    <h2>Minhas Solicitações</h2>
    {% if perms.app_entregas.add_solicitacao %}
      <a class="btn" href="{% url 'app_entregas:criar_solicitacao' %}">Nova Solicitação</a>
    {% endif %}
  </div>
  <div class="card-body">
    {% if solicitacoes %}
      <div class="table-responsive">
        <table class="table">
          <thead>
            <tr><th>Data</th><th>EPI</th><th>Qtd</th><th>Status</th></tr>
          </thead>
          <tbody>
            {% for s in solicitacoes %}
            <tr>
              <td>{{ s.criado_em|date:"d/m/Y H:i" }}</td>
              <td>{{ s.epi.nome }}</td>
              <td>{{ s.quantidade }}</td>
              <td>{{ s.get_status_display }}</td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
      {% if is_paginated %}
        <div class="pagination">
          {% if page_obj.has_previous %}<a href="?page={{ page_obj.previous_page_number }}">« Anterior</a>{% endif %}
          <span>Página {{ page_obj.number }} de {{ page_obj.paginator.num_pages }}</span>
          {% if page_obj.has_next %}<a href="?page={{ page_obj.next_page_number }}">Próxima »</a>{% endif %}
        </div>
      {% endif %}
    {% else %}
      <p>Você ainda não fez solicitações.</p>
    {% endif %}
  </div>
</div>
{% endblock %}
